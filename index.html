<!doctype html>
<html class="no-js">

<head>
    <meta charset="UTF-8">
    <title>LaserWeb</title>

    <!--IE Compatibility modes-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!--Mobile first-->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap and UX -->
    <link type="text/css" rel="stylesheet" media="all" href="lib/bootstrap/css/bootstrap.min.css" id="theme_css" />
    <link type="text/css" rel="stylesheet" media="all" href="lib/bootstrap/css/bootstrap-callouts.css" />
    <link type="text/css" rel="stylesheet" media="all" href="css/main.css" id="extra_css" />

    <script src="lib/jquery/jquery.min.js"></script>
    <script src="lib/jquery/mindmup-editabletable.js"></script>

    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap-filestyle.js"></script>
    <script src="lib/bootstrap/js/dropdowns-enhancement.js"></script>

    <link type="text/css" rel="stylesheet" media="all" href="lib/bootstrap/css/bootstrap-colorselector.css" id="extra_css" />
    <script src="lib/bootstrap/js/bootstrap-colorselector.js"></script>

    <script src="lib/nprogress/nprogress.js"></script>
    <link rel="stylesheet" href="lib/nprogress/nprogress.css" />

    <link rel="stylesheet" href="lib/jquery/jquery-ui.css" />
    <script src="lib/jquery/jquery-ui.js"></script>

    <!-- Font -->
    <link rel="stylesheet" href="css/font-awesome.css" />

    <!-- ThreeJS -->
    <script src="lib/threejs/three.min.js"></script>
    <script src="lib/threejs/GridRect.js"></script>
    <script src="lib/threejs/OrbitControls.js"></script>
    <script src="lib/threejs/Projector.js"></script>
    <script src="lib/threejs/CanvasRenderer.js"></script>
    <script src="lib/threejs/TransformControls.js"></script>
    <script src="lib/threejs/TweenMax.min.js"></script>

    <script src="js/viewer.js"></script>

    <!-- Serial Port JSON -->
    <script src="js/spjs.js"></script>

    <!-- DXF Library -->
    <script type="text/javascript" src="lib/dxf/dxf-parser.js"></script>
    <script type="text/javascript" src="lib/dxf/three-dxf.js"></script>
    <script type="text/javascript" src="js/dxf-render.js"></script>

    <!-- SVG New Lib -->
    <script type="text/javascript" src="lib/snap/snap.svg-min.js"></script>
    <script type="text/javascript" src="js/svg-render.js"></script>

    <!-- Three CAM -->
    <script type="text/javascript" src="js/fileprep.js"></script>
    <script type="text/javascript" src="js/threegcode.js"></script>
    <script type="text/javascript" src="lib/clipperjs/clipper_unminified.js"></script>

    <!-- Raster CAM -->
    <script type="text/javascript" src="js/raster.js"></script>
    <script type="text/paperscript" src="js/laserraster.js" canvas="canvas-1"></script>
    <script type="text/javascript" src="lib/paperjs/paper-full.min.js"></script>

    <!-- STL Cam -->
    <script type="text/javascript" src="lib/slacer/stl.js"></script>
    <script type="text/javascript" src="lib/slacer/slicer.js"></script>
    <script type="text/javascript" src="lib/slacer/mesh.js"></script>
    <script type="text/javascript" src="js/stlcam.js"></script>

    <!-- Jog Widget -->
    <script type="text/javascript" src="js/jog.js"></script>

    <!-- Smoothie Ethernet -->
    <script type="text/javascript" src="js/smoothie.js"></script>

    <!-- Grbl -->
    <script type="text/javascript" src="js/grbl.js"></script>

    <!-- Macros Panel -->
    <script src="js/macros.js"></script>

    <!-- Saved/load settings -->
    <script src="js/localstorage.js"></script>


    <!-- Gcode Viewer -->
    <script src="lib/gcode-viewer/gcode-parser.js"></script>
    <script src="lib/gcode-viewer/ui.js"></script>

    <!-- User Interface -->
    <script src="js/main.js"></script>

    <!--Google Sign-in-->
    <!-- <script src="https://apis.google.com/js/platform.js"></script> -->
    <script src="https://apis.google.com/js/client.js"></script>
    <script src="js/googlesignin.js"></script>
    <meta name="google-signin-client_id" content="1086441811451-4nmidqbqq8tve1qqa592uq1hs04kl5sl.apps.googleusercontent.com">
    <link rel="stylesheet" href="css/googlesignin.css" />

</head>

</body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">LaserWeb</a>
            <form class="navbar-form navbar-left" role="form">
                <span class="btn btn-lg btn-default btn-file" title="Open a png, .jpg, .jpeg, .bmp, .gcode, .svg, .dxf, or .stl file"><i class="fa fa-folder-open fa-fw"></i>Open<input id="file" type="file" accept=".png,.jpg,.jpeg,.bmp,.gcode,.g,.svg,.dxf,.stl" /></span>
            </form>

            <form class="navbar-form navbar-left" role="form">
                <div class="form-group">
                    <label for="port"><i class="fa fa-usb fa-lg"></i></label>
                    <!--input type="select" class="form-control" id="port" -->
                    <select id="port" class="form-control input-lg" disabled>
                        <option value="no">Select port</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="buffer"><i class="fa fa-link fa-lg"></i></label>
                    <!--input type="select" class="form-control" id="baud"-->
                    <select id="buffer" class="form-control input-lg" disabled>
                        <option value="no">Select buffer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="baud"><i class="fa fa-tty fa-lg"></i></label>
                    <!--input type="select" class="form-control" id="baud"-->
                    <select id="baud" class="form-control input-lg" disabled>
                        <option value="230400">230400</option>
                        <option value="115200" selected="selected">115200</option>
                        <option value="57600">57600</option>
                        <option value="38400">38400</option>
                        <option value="19200">19200</option>
                        <option value="9600">9600</option>
                    </select>
                </div>
                <a class="btn btn-lg btn-default disabled" id="connect" href="#">Connect</a>
                <a class="btn btn-lg btn-default" id="refreshPort" href="#"><i class="fa fa-refresh"></i></a>
            </form>

        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-3 col-md-3 sidebar">
            <ul class="nav nav-sidebar">
                <table class="table">
                    <tr>
                        <td>
                            <a class="user-link" href=""><img id="userpic" class="media-object img-thumbnail user-img" alt="User Picture" src="css/user64.gif" height="64" width="64"></a>
                        </td>
                        <td>
                            <h5 id="fullname">Sign In:</h5>
                            <div id="gSignInWrapper">
                                <button class="btn btn-success customGPlusSignIn" id="g-login"><i class="fa fa-fw fa-google" aria-hidden="true"></i>Login<i class="fa fa-fw fa-sign-in" aria-hidden="true"></i></button>
                                <button class="btn btn-danger customGPlusSignIn" id="g-logout" onclick="signOut();" style="display:none;"><i class="fa fa-fw fa-google" aria-hidden="true"></i>Logout<i class="fa fa-fw fa-sign-out" aria-hidden="true"></i></button>
                                <button class="btn btn-success customGPlusSignIn" id="g-refresh" onclick="listFiles();" style="display:none;"><i class="fa fa-fw fa-refresh" aria-hidden="true"></i></button>
                            </div>
                        </td>
                    </tr>
                </table>
                <div id="fileList"></div>
            </ul>

            <ul class="nav nav-sidebar">
              <div class="btn-group" role="group">
                <button class="btn btn-default" id="togglemacro">Macros</button>
              </div>
            </ul>

            <ul class="nav nav-tabs nav-justified">
                <li id="toggleviewer" role="presentation" class="active"><a href="#">Home</a></li>
                <li id="togglefile" role="presentation"><a href="#">CAM</a></li>
                <li id="togglesettings" role="presentation"><a href="#">Settings</a></li>
            </ul>





        </div>

        <!-- Main Body -->
        <div class="col-sm-9 col-sm-offset-3 col-md-9 col-md-offset-3 main">

            <div class="row flex-row" id="viewerrow">
                <div class="col-xs-8 , " id="renderArea"></div>
                <div class="col-xs-4">
                    <!-- Right Col -->
                    <ul class="nav nav-tabs nav-justified">
                        <li id="drotabtn" role="presentation" class="active"><a href="#">DRO</a></li>
                        <li id="jogtabbtn" role="presentation"><a href="#">Jog</a></li>
                        <li id="gcodetabbtn" role="presentation"><a href="#">Gcode</a></li>
                    </ul>


                    <div class="row" id="drotab">
                        <span class="pull-right">
                        <span class="badge badge-default badge-notify" title="Items in Queue" id="queueCnt" style="margin-right: 5px;">Queued: 0</span>
                        </span>
                        <br>&nbsp;
                        <br>
                        <div id="mPosition">
                            <div id="mX" class="dro">X: 0.000</div>
                            <div id="mY" class="dro">Y: 0.000</div>
                            <div id="mZ" class="dro">Z: 0.000</div>
                        </div>

                        <div class="collapse in" id="consoleBody">
                            <p class="list-group-item-text">
                                <!-- Command Console -->
                                <div id="console"></div>
                                <div class="input-group">
                                    <span class="input-group-addon" style="width: 60px;"><i class="fa fa-terminal fa-lg"></i></span>
                                    <input type="text" autocomplete="on" class="form-control" id="command">
                                    <span class="input-group-btn">
                                      <button id="sendCommand" class="btn btn-default disabled" disabled="true" type="button"><i class="fa fa-play" style="margin-right: 10px;"></i>Send</button>
                                    </span>
                                </div>
                            </p>
                        </div>
                    </div>


                    <div class="row" id="jogtab" style="display: none;">
                    </div>


                    <div class="row" id="gcodetab" style="display: none;">
                        <textarea id="gcodepreview" style="width: 100%; height: 250px;"></textarea>
                        <button class="btn btn-lg btn-default btn-file" title="Export GCODE to a file" onclick="saveFile()"><i class="fa fa-save fa-fw"></i>Save</span>
                    </div>

                </div>
            </div>

            <div class="row flex-row"><!-- Main Body Bottom Row -->


                <div class="row  flex-row" id="macro_container" style="display: none;">
                    <div class="bs-callout bs-callout-danger" id="macrostatus">
                        <h4><i class="fa fa-fw fa-exclamation" aria-hidden="true"></i>No macros created yet</h4> Please click Edit to start creating your own Macro buttons
                        <ul>
                            <li>Maximum of 24 unique user assignable buttons</li>
                            <li>Specify custom label text</li>
                            <li>Specify the GCode/MCode to be sent to the machine when Macro button is pressed</li>
                            <li>Specify a custom color for the button</li>
                        </ul>
                    </div>
                    <!-- Macro Settings -->
                    <div class="container" id="macro_settings" style="display: none;">

                        <div class="list-group">
                            <a href="#" class="list-group-item"><h4 class="list-group-item-heading">Edit Macro Buttons</h4></a>
                            <p class="list-group-item-text">
                                Configure Labels and G-Code commands for up to 24 buttons:

                        </div>
                        <div class="table-responsive settingstable">
                            <table class="table" id="macroEdit">
                                <thead>
                                    <tr>
                                        <th data-formatter="runningFormatter">Button #</th>
                                        <th>Label</th>
                                        <th>G-Code</th>
                                        <th>Color</th>
                                        <th>Delete</th>
                                    </tr>
                                </thead>
                                <tbody id="macrostbody">
                                </tbody>
                            </table>
                            <button type="button" class="btn btn-sm btn-default" id="addrow"><i class="fa fa-w fa-plus"></i></button>

                        </div>

                    </div>
                    <!-- Macro Panel -->
                    <div class="container" id="macro_pad">
                        <!-- Dynamically Populated by readMacros() -->
                    </div>
                    <!-- Edit/Save Macro Buttons -->
                    <div class="row">
                        <hr>
                        <div class="col-sm-4"></div>
                        <div class="col-sm-4">
                            <button type="button" class="btn btn-lg btn-default" id="savemacro" style="width:100%; height:100%; display: none;"><i class="fa fa-w fa-floppy-o"></i>&nbsp;Save</button>
                            <button type="button" class="btn btn-lg btn-default" id="editmacro" style="width:100%; height:100%;"><i class="fa fa-w fa-pencil-square-o"></i>&nbsp;Edit</button>
                        </div>

                    </div>
                </div>

                <div class="row flex-row" id="viewer_container">

                    <div class="btn-group" role="group" id="transformcontrols">
                        <button type="button" data-title="Move Object" class="btn btn-lg btn-default" id="translateBtn"><i class="fa fa-arrows fa-lg"></i></button>
                        <button type="button" data-title="Resize Object" class="btn btn-lg btn-default" id="resizeBtn"><i class="fa fa-expand fa-lg"></i></button>
                        <button type="button" data-title="Link Aspect" class="btn btn-lg btn-default" id="linkAspectBtn"><i id='linkAspect' class="fa fa-link fa-lg"></i></button>
                    </div>

                    <div class="btn-group" role="group" id="pan controls"  style="vertical-align: bottom; margin-left: 18px;">
                      <button type="button" data-title="Reset Camera" class="btn btn-lg btn-default" id="viewReset"><i class="fa fa-search fa-fw"></i></button>
                    </div>

                    <div class="btn-group" role="group" id="pan controls"  style="vertical-align: bottom; margin-left: 18px;">
                        <div class="btn-group input-group  btn-group-vertical" role="group" id="panvert" aria-label="Vertical Pan"  style="vertical-align: bottom;">
                          <button onclick='jQuery.Event( "DOMMouseScroll",{delta: -650} );' type="button" data-title="Zoom Out" class="btn btn-lg btn-default" id="zoomout"><i class="fa fa-search-minus"></i></button>
                          <button type="button" data-title="Pan Left" class="btn btn-lg btn-default" id="panleft"><i class="fa fa-arrow-left"></i></button>
                        </div>
                        <div class="btn-group input-group  btn-group-vertical" role="group" id="panvert" aria-label="Vertical Pan"  style="vertical-align: bottom;">
                            <button type="button" data-title="Pan Up" class="btn btn-lg btn-default" id="panup"><i class="fa fa-arrow-up"></i></button>
                            <button type="button" data-title="Pan Down" class="btn btn-lg btn-default" id="pandown"><i class="fa fa-arrow-down"></i></button>
                        </div>
                        <div class="btn-group input-group  btn-group-vertical" role="group" id="panvert" aria-label="Vertical Pan"  style="vertical-align: bottom;">
                          <button onclick='jQuery.Event( "DOMMouseScroll",{delta: +650} );' type="button" data-title="Zoom In" class="btn btn-lg btn-default" id="zoomin"><i class="fa fa-search-plus"></i></button>
                          <button type="button" data-title="Pan Right" class="btn btn-lg btn-default" id="panright"><i class="fa fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>

                <div class="row flex-row" id="control_container" style="display: none;">

                    <div class="bs-callout bs-callout-danger" id="controlstatus">
                        <h4><i class="fa fa-fw fa-exclamation" aria-hidden="true"></i>Not connected to a machine</h4> Please Connect to a machine first:
                        <ul>
                            <li>Download spjs</li>
                            <li>Plug in your machine's controller and run spjs</li>
                            <li>Click "refresh ports", select a port, protocol and baud rate</li>
                            <li>Click 'Connect'</li>
                        </ul>
                    </div>

                    <div class="col-sm-10">
                        <div class="list-group" id="dromodule">
                            <span class="list-group-item">
                                      <h4 class="list-group-item-heading">Jog Control<a data-toggle="collapse" href="#jogBody" aria-expanded="false" aria-controls="jogBody"><span class="pull-right"><i class="fa fa-bars" style="color: #aaa;" title="Minimise"></i></span></a>
                            </h4>
                            <div class="collapse in" id="jogBody">
                                <p class="list-group-item-text">
                                    <div class="col-sm-10">
                                        <div class="btn-group input-group  btn-group-justified" role="group" id="jogx" aria-label="X Moves">
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 X-10\nG90\n');">-10</button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 X-1\nG90\n');">-1</button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 X-0.1\nG90\n');">-0.1</button>
                                            </div>
                                            <div class="btn-group input-group  btn-group-vertical" role="group" id="jogy" aria-label="Y Moves">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 Y10\nG90\n');">+10</button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 Y1\nG90\n');">+1</button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 Y0.1\nG90\n');">+0.1</button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #dedbdb;"><i class="fa fa-arrows" aria-hidden="true"></i></button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 Y-0.1\nG90\n');">-0.1</button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 Y-1\nG90\n');">-1</button>
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 Y-10\nG90\n');">-10</button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 X0.1\nG90\n');">+0.1</button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 X1\nG90\n');">+1</button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 X10\nG90\n');">+10</button>

                                            </div>
                                        </div>
                                        <br>


                                    </div>
                                    <div class="col-sm-2">
                                        <div class="btn-group input-group  btn-group-vertical" role="group" id="jogz" aria-label="Z Moves">
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 Z10\nG90\n');">Z+10</button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 Z1\nG90\n');">Z+1</button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 Z0.1\nG90\n');">Z+0.1</button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #dedbdb;"><i class="fa fa-arrows-v" aria-hidden="true"></i></button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #cacaca;" onclick="sendGcode('G91\nG0 Z-0.1\nG90\n');">Z-0.1</button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #bebebe;" onclick="sendGcode('G91\nG0 Z-1\nG90\n');">Z-1</button>
                                            <button type="button" class="btn btn-lg btn-default" style="background-color: #9f9f9f;" onclick="sendGcode('G91\nG0 Z-10\nG90\n');">Z-10</button>
                                        </div>

                                    </div>
                                </p>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="btn-group input-group  btn-group-justified" role="group" id="MacGrp" aria-label="Job Control">
                                            <!-- span class="input-group-addon"><i class="fa fa-cube"></i></span -->
                                            <div class="btn-group" role="group" id="unlockBtnGrp" style="display: none;">
                                                <button type="button" class="btn btn-default" id="unlockBtn" onclick="unlockMachine();"><i class="fa fa-unlock fa-lg"></i></button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" id="homeBtn" onclick="homeMachine();"><i class="fa fa-home fa-lg"></i></button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" id="playBtn" onclick="playpauseMachine();"><i id="playicon" class="fa fa-play fa-lg"></i></button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" id="stopBtn" onclick="stopMachine();"><i class="fa fa-stop fa-lg"></i></button>
                                            </div>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-lg btn-default" id="zeroBtn" onclick="sendGcode('G92 X0 Y0 Z0');"><i class="fa fa-location-arrow fa-lg"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <!-- Collapse Body -->
                            </span>
                        </div>
                    </div>

                </div>

                <div class="row flex-row" id="file_container" style="display: none;">

                    <div class="bs-callout bs-callout-danger" id="filestatus">
                        <h4><i class="fa fa-fw fa-exclamation" aria-hidden="true"></i>No File to work with</h4> Please open a file from the "Open" button:
                        <br> SVG (Paths only, single group), DXF (R14 Lines/Polylines/Circles), BMP/PNG/JPEG (Raster Engraving) and GCODE (External CAM) are all supported
                    </div>
                    <!-- Module CAM -->
                    <div class="list-group" id="cammodule" style="display: none;">
                        <span class="list-group-item">
                                <h4 class="list-group-item-heading">Prepare Job<span class="pull-right"><a data-toggle="collapse" href="#camBody" aria-expanded="false" aria-controls="camBody"><i class="fa fa-bars" style="color: #aaa;" title="Minimise"></i></span></a>
                        </h4>
                        <div class="collapse in" id="camBody">
                            <p class="list-group-item-text">

                                <!-- Nav tabs -->
                                <ul class="nav nav-tabs" role="tablist">
                                    <li><a href="#stltab" id="stlopt" role="tab" data-toggle="tab" style="display: none;">STL</a></li>
                                    <li class="active"><a href="#preptab" id="prepopt" role="tab" data-toggle="tab">Prepare</a>
                                    </li>
                                    <li><a href="#convtab" role="tab" data-toggle="tab">Convert</a></li>
                                </ul>
                                <!-- Tab panes -->

                                <!-- Tab 1 -->
                                <div class="tab-content">
                                    <div class="tab-pane active" id="preptab">
                                        <div class="btn-group" role="group" aria-label="cam">
                                            <!-- Row 2 -->
                                            <p>
                                                <div id="inflateFeature" class="input-group" style="width: 100%;">
                                                    <span class="input-group-addon">Tool Offset:</span>
                                                    <div class="input-group">
                                                        <input type="number" step="0.1" class="form-control  input-sm" value="1" id="inflateVal" style="text-align:right;">
                                                        <span class="input-group-addon">mm</span>
                                                    </div>
                                                    <span class="input-group-btn">
                                                        <button id="stepinfup" class="btn btn-default btn-sm" type="button"><i class="fa fa-caret-up"></i></button>
                                                        <button id="stepinfdn" class="btn btn-default btn-sm" type="button"><i class="fa fa-caret-down"></i></button>
                                                        <button id="removeInflateGrp" class="btn btn-default btn-sm" type="button"><i class="fa fa-times"></i></button>
                                                      </span>
                                                </div>
                                                <p>
                                                    <div class="input-group" style="width: 100%;">
                                                        <span class="input-group-addon">Scale:</span>
                                                        <div class="input-group">
                                                            <input type="number" class="form-control  input-sm" value="100" id="scaleFactor" style="text-align:right;">
                                                            <span class="input-group-addon">%</span>
                                                            <span class="input-group-btn">
                                                                <button id="stepscaleup" class="btn btn-default btn-sm" type="button"><i class="fa fa-caret-up"></i></button>
                                                                <button id="stepscaledn" class="btn btn-default btn-sm" type="button"><i class="fa fa-caret-down"></i></button>
                                                              </span>

                                                            <!-- <span class="input-group-btn">
                                <button id="dpi96" class="btn btn-default btn-sm" type="button">96dpi</button>
                              </span>
                              <span class="input-group-btn">
                              <button id="dpi90" class="btn btn-default btn-sm" type="button">90dpi</button>
                            </span> -->
                                                        </div>
                                                    </div>
                                                    <p>
                                                        <div class="input-group" style="width: 100%;">
                                                            <span class="input-group-addon">Position:</span>
                                                            <div class="input-group">
                                                                <input type="number" class="form-control  input-sm" value="0" id="xpos" style="text-align:right;">
                                                                <span class="input-group-addon">X</span>
                                                                <input type="number" class="form-control  input-sm" value="0" id="ypos" style="text-align:right;">
                                                                <span class="input-group-addon">Y</span>
                                                            </div>
                                                        </div>
                                        </div>
                                    </div>

                                    <!-- Tab 2 -->
                                    <div class="tab-pane" id="convtab">
                                        <p>
                                            <div class="btn-group btn-group-justified" role="group" aria-label="gengcode">
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-default" id="generategcode">Generate G-Code</button>
                                                </div>
                                            </div>
                                            <table class="table table-hover table-striped" id="layers">
                                                <caption>Configure parameters per layer</caption>
                                                <thead>
                                                    <tr>
                                                        <th>Layer</th>
                                                        <th>Settings</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="layersbody">
                                                </tbody>
                                            </table>
                                    </div>

                                    <!-- Tab 3 -->
                                    <div class="tab-pane" id="stltab">
                                        <p>
                                            <div class="input-group" style="width: 100%;">
                                                <span class="input-group-addon">Original STL:</span>
                                                <div class="btn-group btn-group-justified" role="group" aria-label="stltab">
                                                    <div class="btn-group" role="group">
                                                        <button type="button" class="btn btn-sm btn-default" id="showstl" onclick="showstl()">Show</button>
                                                    </div>
                                                    <div class="btn-group" role="group">
                                                        <button type="button" class="btn btn-sm btn-default" id="hidestl" onclick="hidestl()">Hide</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <p>
                                                <div class="btn-group btn-group-justified" role="group" aria-label="stltab">
                                                    <div class="btn-group" role="group">
                                                        <button type="button" class="btn btn-default" id="generateslices" onclick="generateSlices();">Slice STL</button>
                                                    </div>
                                                </div>
                                                Configure thickness per layer - usually this equates to the thickness of the material you'll be cutting the slices from:
                                                <p>
                                                    <div class="input-group" style="width: 100%;">
                                                        <span class="input-group-addon">Layer Height:</span>
                                                        <div class="input-group">
                                                            <input type="number" step="0.1" class="form-control  input-sm" value="1.5" id="layerheight" style="text-align:right;">
                                                            <span class="input-group-addon">mm</span>
                                                        </div>
                                                    </div>
                                                    <p>
                                    </div>
                                </div>
                                <!-- <div class="tab-content"> -->
                        </div>
                        <!-- <div class="collapse in" id="camBody"> -->
                    </div>

                    <!-- End Module CAM -->
                    <div class="canvas" id="rasterOutput" style="display: none;">
                        <canvas id="canvas-1"></canvas>
                    </div>
                    <!-- Module Raster -->
                    <div class="list-group" id="rastermodule" style="display: none;">
                        <div class="col-xs-5">
                            <span class="list-group-item">
                                    <h4 class="list-group-item-heading">Raster<a data-toggle="collapse" href="#rasterBody" aria-expanded="false" aria-controls="rasterBody"><span class="pull-right"><i class="fa fa-bars" style="color: #aaa;" title="Minimise"></i></span></a>
                            </h4>
                            <div class="collapse in" id="rasterBody">
                                <p class="list-group-item-text">
                                    <div class="" id="rasterparams">
                                        <div class="well">
                                            <label for="laserpwrsliderlbl">Constrain Laser Power: </label>
                                            <span id="laserpwr" style="border:0;  font-weight:bold; background: transparent;"></span>
                                            <div id="laserpwrslider"></div>
                                        </div>
                                        <div class="well">
                                            <input type="checkbox" value="1" id="useRasterBlackWhiteSpeeds" /> Enable Adaptive Feedrate Grayscale Control
                                            <div class="" id="blackwhitespeedsection" style="display: none;">
                                                <span style="font-size: 10px; font-color: #ccc">This feature allows you to fine tune the grayscale for linearity based on the material in use. </span>
                                                <center>
                                                    <label for="laservariablespeedlbl">Feedrate for lightest (white) and darkest (black)</label>
                                                    <br>
                                                    <div id="laservariablespeedslider"></div>
                                                    <span id="laservariablespeed" style="border:0;  font-weight:bold; background: transparent;"></span><span>&nbsp;mm/min</span>
                                                </center>
                                            </div>
                                        </div>
                                        <div class="well">
                                            <label for="spotsizesliderlbl">Zoom/Resolution: </label>
                                            <span id="spotsize" style="border:0;  font-weight:bold; background: transparent;"></span>
                                            <div id="spotsizeslider"></div>
                                        </div>
                                        <div class="input-group" style="margin-bottom:10px; width: 100%;">
                                            <span class="input-group-addon" style="width: 100px;"><i class="fa fa-line-chart fa-lg" style="margin-right: 20px;"></i>Engrave (G1) Feedrate</span>
                                            <input type="text input-sm" class="form-control" value="2000" id="feedRate">
                                            <span class="input-group-addon" style="width: 60px;">mm/min</span>
                                        </div>
                                        <div class="input-group" style="margin-bottom:10px; width: 100%;">
                                            <span class="input-group-addon" style="width: 100px;"><i class="fa fa-line-chart fa-lg" style="margin-right: 20px;"></i>Rapid (G0) Feedrate</span>
                                            <input type="text input-sm" class="form-control" value="6000" id="rapidRate">
                                            <span class="input-group-addon" style="width: 60px;">mm/min</span>
                                        </div>
                                        <center>
                                            <a class="btn btn-sm btn-default disabled" id="rasterNow"><i class="fa fa-square-o fa-lg" style="margin-right: 3px;"></i>Prepare Raster</a>
                                            <!-- button type="button" class="btn btn-danger disabled" id="rasterWidgetSendRasterToLaser"><i class="fa fa-fire" style="margin-right: 8px;"></i>Send to Laser</button -->
                                        </center>
                                        <center>
                                            Imported Image Dimensions: <span id="dims">0px x 0 px</span>
                                            <br> Engraved Image Dimensions: <span id="physdims">0mm x 0 mm</span>
                                            <br>
                                            <div style="display: none;">
                                                <img id="origImage" style="border: 1px solid #555;  max-width:300px;">
                                            </div>
                                        </center>
                                        <hr>
                                        <div class="canvas" id="rasterOutput" style="display: none;">
                                            <canvas id="canvas-1"></canvas>
                                        </div>
                                    </div>
                                    <!-- rasterparams -->
                                    <div id="rasterProgressShroud">

                                        <center>
                                            <h3>Converting...</h3>
                                            <span id="rasterProgressPerc"></span>
                                        </center>
                                        <!-- <div class="progress">
                                          <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
                                          <span class="sr-only">0% Complete</span>
                                        </div>
                                      </div> -->
                                    </div>
                                    <!-- rastershroud -->
                                </p>
                            </div>
                            </span>
                        </div>
                    </div>
                    </span>


                </div>

                <div class="row flex-row" id="settings_container" style="display: none;">
                    <ul class="nav nav-tabs nav-justified">
                        <li class="active"><a data-toggle="tab" href="#home">SPJS</a></li>
                        <li><a data-toggle="tab" href="#menu1">Machine</a></li>
                        <li><a data-toggle="tab" href="#menu2">G-Code</a></li>
                        <li><a data-toggle="tab" href="#menu3">Application</a></li>
                        <li><a data-toggle="tab" href="#menu4">Backup/Restore</a></li>
                    </ul>
                    <br>
                    <div class="tab-content">
                        <div id="home" class="tab-pane fade in active">
                            <br>
                            <div class="list-group">
                                <a href="#" class="list-group-item">
                                    <h4 class="list-group-item-heading">SPJS</h4>
                                    <p class="list-group-item-text">
                                        Download and run the SPJS Server to connect LaserWeb to your Machine:
                                        <br> V1.88 Build date: Feb 6, 2015

                                        <form class="form-horizontal">
                                            <div class="form-group">
                                                <label for="laserXMax" class="control-label col-xs-3">IP Address</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="spjsip" placeholder="127.0.0.1">
                                                </div>
                                            </div>
                                        </form>

                                        <div class="list-group">
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_windows_386.zip">Windows x32</a>
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_windows_amd64.zip">Windows x64</a>
                                            <!--<a class="list-group-item" target="_blank" href="http://chilipeppr.com/downloads/v1.86/serial-port-json-server-1.86_darwin_amd64.zip">Mac OS X x64</a>-->
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_linux_386.tar.gz">Linux x32</a>
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_linux_amd64.tar.gz">Linux x64</a>
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_linux_arm.tar.gz">Raspberry Pi (Linux ARM)</a>
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_linux_arm.tar.gz">Beagle Bone Black (Linux ARMv7)</a>
                                            <a class="list-group-item" href="https://github.com/chilipeppr/serial-port-json-server/releases/download/v1.88/serial-port-json-server-1.88_linux_amd64.tar.gz">Intel Edison (Linux x64)</a>
                                            <a class="list-group-item" target="_blank" href="http://github.com/chilipeppr/serial-port-json-server/releases">Github Release Page</a>
                                            <a class="list-group-item" target="_blank" href="http://github.com/chilipeppr/serial-port-json-server">Compile from source (Github)</a>
                                        </div>
                                    </p>
                                </a>
                            </div>
                        </div>
                        <div id="menu1" class="tab-pane fade">
                            <br>
                            <div class="list-group">
                                <a href="#" class="list-group-item">
                                    <h4 class="list-group-item-heading">Machine Settings</h4>
                                    <p class="list-group-item-text">
                                        Configure LaserWeb 2.0 to your machine specifics:
                                        <br>
                                        <i>(NB: Page needs a refresh for these settings to take effect!)</i>
                                        <form class="form-horizontal">
                                            <br>
                                            <div class="form-group">
                                                <label for="laserXMax" class="control-label col-xs-3">X-Length</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="laserXMax" placeholder="600">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="laserYMax" class="control-label col-xs-3">Y-Length</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="laserYMax" placeholder="400">
                                                </div>
                                            </div>

                                        </form>
                                    </p>
                                </a>
                            </div>
                        </div>
                        <div id="menu2" class="tab-pane fade">
                            <br>
                            <form class="form-horizontal">
                                <div class="list-group">
                                    <a href="#" class="list-group-item">
                                        <h4 class="list-group-item-heading">G-Code Settings</h4>
                                        <p class="list-group-item-text">
                                            Configure pre/post/control GCode commands:
                                            <div class="form-group">
                                                <label for="startgcode" class="control-label col-xs-3">Start G-Code</label>
                                                <div class="col-xs-9">
                                                    <textarea class="form-control" id="startgcode" placeholder="G28\nG90\nM80"></textarea>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="laseron" class="control-label col-xs-3">Laser ON Command</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="laseron" placeholder="M3 / blank for firmwares that support G1"></input>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="laseroff" class="control-label col-xs-3">Laser OFF Command</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="laseroff" placeholder="M5 / blank for firmwares that support G1"></input>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="laseroff" class="control-label col-xs-3">PWM Max S</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="lasermultiply" placeholder="255"></input>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="homingseq" class="control-label col-xs-3">Homing Sequence</label>
                                                <div class="col-xs-9">
                                                    <input type="text" class="form-control" id="homingseq" placeholder="G28"></input>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="endgcode" class="control-label col-xs-3">End G-Code</label>
                                                <div class="col-xs-9">
                                                    <textarea class="form-control" id="endgcode" placeholder="M81\nG28\n"></textarea>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="endgcode" class="control-label col-xs-3">Travel Moves (mm/min)</label>
                                                <div class="col-xs-9">
                                                    <textarea class="form-control" id="rapidspeed" placeholder="2000"></textarea>
                                                </div>
                                            </div>
                            </form>
                            </p>
                            </a>
                            </div>
                        </div>


                        <div id="menu3" class="tab-pane fade">
                            <br>
                            <form class="form-horizontal">
                                <div class="list-group">
                                    <a href="#" class="list-group-item">
                                        <h4 class="list-group-item-heading">Application Settings</h4>
                                        <p class="list-group-item-text">
                                            Configure how the application works, turn on/off features:
                                            <div class="form-group">
                                                <label for="endgcode" class="control-label col-xs-3">Experimental: Tool Offset </label>
                                                <div class="col-xs-9">
                                                    <select class="form-control" id="useOffset">
                                                        <option>Enable</option>
                                                        <option>Disable</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="imagePosition" class="control-label col-xs-3">Place uploaded image in quadrant</label>
                                                <div class="col-xs-9">
                                                    <select class="form-control" id="imagePosition">
                                                        <option>BottomLeft</option>
                                                        <option>TopLeft</option>
                                                    </select>
                                                </div>
                                            </div>
                            </form>
                            </p>
                            </a>
                            </div>
                        </div>

                        <div id="menu4" class="tab-pane fade">

                            <br>
                            <form class="form-horizontal">
                                <div class="list-group">
                                    <a href="#" class="list-group-item">
                                        <h4 class="list-group-item-heading">Backup/Restore your settings/macros</h4>
                                        <p class="list-group-item-text">
                                            Download a backup or restore settings from a backup file:
                                            <div class="form-group">
                                                <label for="backup" class="control-label col-xs-7">Export all your custom machine/gcode/application settings as well as custom Macro buttons. Please ensure you always have a backup at hand</label>
                                                <div class="col-xs-5">
                                                    <div class="btn-group input-group  btn-group-justified" role="group" id="jogx" aria-label="X Moves">
                                                        <div class="btn-group" role="group">
                                                            <button id="backup" class="btn btn-lg btn-default btn-file" title="Take a backup" onclick="backupSettingsLocal()"><i class="fa fa-download fa-fw" aria-hidden="true"></i></i>Backup Settings/Macros</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="restore" class="control-label col-xs-7"> If you have a backed up laserweb-settings-backup.json file you can restore it to this instance of LaserWeb</label>
                                                <div class="col-xs-5">
                                                    <div class="btn-group input-group  btn-group-justified" role="group" id="jogx" aria-label="X Moves">
                                                        <div class="btn-group" role="group">
                                                            <span id="restore" class="btn btn-lg btn-default btn-file" title="Open a backup settings file"><i class="fa fa-upload  fa-fw" aria-hidden="true"></i>Restore from file<input id="jsonFile" type="file" accept=".json" /></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                    </a>
                                </div>
                            </form>
                        </div>

                        <button type="button" class="btn btn-lg btn-default" data-dismiss="modal" id="savesettings">Save</button>
                        <button type="button" class="btn btn-lg btn-default" data-dismiss="modal">Cancel</button>
                    </div>
                </div>

            </div>
        </div><!-- End of Main Body -->
    </div><!-- End of Main Row -->
</div><!-- End of Container Fluid -->

<!-- End Main Body Div -->
</body>
</html>
